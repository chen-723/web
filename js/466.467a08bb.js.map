{"version":3,"file":"js/466.467a08bb.js","mappings":"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","sources":["webpack://my-vue2-project/./src/api/index.js","webpack://my-vue2-project/./src/views/HomePage.vue","webpack://my-vue2-project/src/views/HomePage.vue","webpack://my-vue2-project/./src/views/HomePage.vue?92db","webpack://my-vue2-project/./src/views/HomePage.vue?406d"],"sourcesContent":["import axios from 'axios'\r\n\r\n// 根据后端实际地址修改\r\nconst baseURL = 'https://111dc5664cn09.vicp.fun/api';  //跑本地也用这个，因为已经映射过了\r\n//  const baseURL = 'http://localhost:3000/api'         //这个纯本地\r\nconst api = axios.create({\r\n  baseURL,\r\n  timeout: 5000\r\n})\r\n\r\nexport const login = (username, password) =>\r\n  api.post('/login', { username, password })\r\n\r\n// 获取历史消息\r\nexport const fetchMessages = () => api.get('/chat/messages')\r\n\r\n// 发送消息\r\nexport const sendMessage = (payload) =>\r\n  api.post('/chat/messages', payload)","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticStyle:{\"text-align\":\"center\",\"margin-top\":\"60px\"}},[(_vm.user.avatar_url)?_c('img',{staticStyle:{\"border-radius\":\"50%\"},attrs:{\"src\":_vm.user.avatar_url,\"width\":\"80\",\"height\":\"80\"}}):_vm._e(),_c('h2',[_vm._v(\"欢迎，\"+_vm._s(_vm.user.username)+\"!\")]),_c('p',[_vm._v(\"邮箱：\"+_vm._s(_vm.user.email || '暂无'))]),_c('p',[_vm._v(\"注册时间：\"+_vm._s(_vm.user.created_at || '未知'))]),_c('button',{on:{\"click\":_vm.logout}},[_vm._v(\"退出登录\")]),_c('button',{staticStyle:{\"margin\":\"8px\"},on:{\"click\":_vm.loadMessages}},[_vm._v(\"刷新消息\")]),_c('div',{staticStyle:{\"max-width\":\"500px\",\"margin\":\"40px auto\"}},[_c('div',{ref:\"msgBox\",staticStyle:{\"height\":\"260px\",\"border\":\"1px solid #ccc\",\"border-radius\":\"6px\",\"padding\":\"8px\",\"overflow-y\":\"auto\",\"background\":\"#fafafa\",\"text-align\":\"left\"}},_vm._l((_vm.messages),function(m){return _c('div',{key:m.id,staticStyle:{\"margin\":\"4px 0\"}},[_c('b',[_vm._v(_vm._s(m.username))]),_vm._v(\" \"),_c('small',{staticStyle:{\"color\":\"#888\"}},[_vm._v(_vm._s(m.created_at))]),_c('br'),_vm._v(\" \"+_vm._s(m.content)+\" \")])}),0),_c('div',{staticStyle:{\"display\":\"flex\",\"margin-top\":\"8px\"}},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.newMsg),expression:\"newMsg\"}],staticStyle:{\"flex\":\"1\",\"padding\":\"6px 8px\",\"border\":\"1px solid #ccc\",\"border-radius\":\"4px\"},attrs:{\"placeholder\":\"说点什么...\"},domProps:{\"value\":(_vm.newMsg)},on:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\"))return null;return _vm.sendMsg.apply(null, arguments)},\"input\":function($event){if($event.target.composing)return;_vm.newMsg=$event.target.value}}}),_c('button',{staticStyle:{\"margin-left\":\"6px\",\"padding\":\"6px 12px\"},on:{\"click\":_vm.sendMsg}},[_vm._v(\"发送\")])])])])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div style=\"text-align:center;margin-top:60px;\">\r\n    <!-- 1. 原用户信息 -->\r\n    <img v-if=\"user.avatar_url\" :src=\"user.avatar_url\" width=\"80\" height=\"80\" style=\"border-radius:50%;\" />\r\n    <h2>欢迎，{{ user.username }}!</h2>\r\n    <p>邮箱：{{ user.email || '暂无' }}</p>\r\n    <p>注册时间：{{ user.created_at || '未知' }}</p>\r\n    <button @click=\"logout\">退出登录</button>\r\n    <button @click=\"loadMessages\" style=\"margin:8px;\">刷新消息</button>\r\n\r\n    <!-- 2. 聊天区域 -->\r\n    <div style=\"max-width:500px;margin:40px auto;\">\r\n      <!-- 消息列表 -->\r\n      <div\r\n        ref=\"msgBox\"\r\n        style=\"height:260px;border:1px solid #ccc;border-radius:6px;padding:8px;overflow-y:auto;background:#fafafa;text-align:left;\"\r\n      >\r\n        <div v-for=\"m in messages\" :key=\"m.id\" style=\"margin:4px 0;\">\r\n          <b>{{ m.username }}</b> <small style=\"color:#888;\">{{ m.created_at }}</small><br/>\r\n          {{ m.content }}\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 输入+发送 -->\r\n      <div style=\"display:flex;margin-top:8px;\">\r\n        <input\r\n          v-model=\"newMsg\"\r\n          @keyup.enter=\"sendMsg\"\r\n          style=\"flex:1;padding:6px 8px;border:1px solid #ccc;border-radius:4px;\"\r\n          placeholder=\"说点什么...\"\r\n        />\r\n        <button @click=\"sendMsg\" style=\"margin-left:6px;padding:6px 12px;\">发送</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { fetchMessages, sendMessage } from '@/api/index.js'\r\n\r\nexport default {\r\n  name: 'HomePage',\r\n  data() {\r\n    return {\r\n      user: JSON.parse(localStorage.getItem('user') || '{}'),\r\n      messages: [],\r\n      newMsg: ''\r\n    }\r\n  },\r\n  created() {\r\n    this.loadMessages()\r\n  },\r\n  methods: {\r\n    logout() {\r\n      localStorage.removeItem('token')\r\n      localStorage.removeItem('user')\r\n      this.$router.replace('/login')\r\n    },\r\n    // 手动刷新消息\r\n    loadMessages() {\r\n      fetchMessages()\r\n        .then(res => {\r\n          if (res.data.code === 0) this.messages = res.data.data\r\n          this.$nextTick(() => {\r\n            const box = this.$refs.msgBox\r\n            box && (box.scrollTop = box.scrollHeight)\r\n          })\r\n        })\r\n        .catch(console.error)\r\n    },\r\n    sendMsg() {\r\n      const content = this.newMsg.trim()\r\n      if (!content) return\r\n\r\n      const payload = {\r\n        user_id: this.user.id || 1,\r\n        username: this.user.username,\r\n        content\r\n      }\r\n\r\n      sendMessage(payload)\r\n        .then(res => {\r\n          if (res.data.code === 0) return this.loadMessages()\r\n          throw new Error(res.data.message)\r\n        })\r\n        .catch(console.error)\r\n        .finally(() => {\r\n          this.newMsg = ''\r\n        })\r\n    }\r\n  }\r\n}\r\n</script>","import mod from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./HomePage.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./HomePage.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./HomePage.vue?vue&type=template&id=7ae9edb5\"\nimport script from \"./HomePage.vue?vue&type=script&lang=js\"\nexport * from \"./HomePage.vue?vue&type=script&lang=js\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports"],"names":["baseURL","api","axios","create","timeout","login","username","password","post","fetchMessages","get","sendMessage","payload","render","_vm","this","_c","_self","staticStyle","user","avatar_url","attrs","_e","_v","_s","email","created_at","on","logout","loadMessages","ref","_l","messages","m","key","id","content","directives","name","rawName","value","newMsg","expression","domProps","$event","type","indexOf","_k","keyCode","sendMsg","apply","arguments","target","composing","staticRenderFns","data","JSON","parse","localStorage","getItem","created","methods","removeItem","$router","replace","then","res","code","$nextTick","box","$refs","msgBox","scrollTop","scrollHeight","catch","console","error","trim","user_id","Error","message","finally","component"],"sourceRoot":""}